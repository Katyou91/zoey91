<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>MindAR åç‰‡äº’å‹•ç¤ºç¯„</title>
<!-- å¼•å…¥ A-Frame èˆ‡ MindAR æ ¸å¿ƒåº« -->
<script src="https://cdn.jsdelivr.net/npm/aframe@1.4.2/dist/aframe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-
aframe.prod.js"></script>
<style>
/* éš±è—æ»¾å‹•æ¢ï¼Œè®“ AR è¦–åœ–å…¨è¢å¹•é¡¯ç¤º */
body {
margin: 0;
overflow: hidden;
}
</style>
<!-- æ’­æ”¾ä¸»éŸ³æª”æŒ‰éˆ•ï¼ˆå·¦ä¸Šï¼‰ -->
<button id="mainBtn" onclick="document.getElementById('mainAudio').play()" 
  style="position: absolute; top: 10px; left: 10px; z-index: 999;
         background: rgba(255,255,255,0.85); padding: 8px 12px; border-radius: 6px;">
  ğŸ”Š æ’­æ”¾éŸ³æª”
</button>

<!-- æ’­æ”¾ä¾‹å¥å€å¡Š -->
<button id="exampleBtn" onclick="toggleExample()"
  style="position: absolute; bottom: 20px; right: 10px; z-index: 999;
         background: rgba(255,255,255,0.85); padding: 8px 12px; border-radius: 6px;">
  ğŸ’¬ ä¾‹å¥
</button>

<div id="exampleBox" style="position: absolute; bottom: 70px; right: 10px; z-index: 999;
             display: none; background: rgba(255,255,255,0.95); padding: 10px; border-radius: 8px;">
  <p style="margin: 0 0 8px 0;">ä¾‹å¥ï¼šã„ã™ã«åº§ã‚‹ã€‚ï¼ˆååœ¨æ¤…å­ä¸Š)</p>
  <button onclick="document.getElementById('exampleAudio').play()">â–¶ æ’­æ”¾ä¾‹å¥</button>
</div>

<!-- éŸ³æª” -->
<audio id="mainAudio" src="doa.mp3"></audio>
<audio id="exampleAudio" src="example-doa.mp3"></audio>

<!-- åˆ‡æ›ä¾‹å¥æ¡†çš„åŠŸèƒ½ -->
<script>
  function toggleExample() {
    const box = document.getElementById("exampleBox");
    box.style.display = box.style.display === "none" ? "block" : "none";
  }
</script>

</head>
<body>
<div id="custom-text">æ¤…å­</div>
<!-- A-Frame å ´æ™¯æ ¹å…ƒç´  -->
<!-- mindar-imageï¼šè¨­å®š AR æ¨™è¨˜æª”æ¡ˆè·¯å¾‘ã€è‡ªå‹•é–‹å§‹èˆ‡ UI é¡¯ç¤º -->
<a-scene
mindar-image="imageTargetSrc: targets.mind; autoStart: true; uiLoading: true; uiError: true; uiScanning: true;"
color-space="sRGB"
renderer="colorManagement: true; physicallyCorrectLights: true"
vr-mode-ui="enabled: false"
device-orientation-permission-ui="enabled: false"
>
<!-- è³‡æºé è¼‰ï¼šè²¼åœ– -->
<a-assets>
<img id="resultImg" src="doa.jpg" />
</a-assets>
<!-- ç’°å¢ƒå…‰ï¼Œé¿å…å ´æ™¯å…¨é»‘ -->
<a-light type="ambient" intensity="3"></a-light>
<!-- ç›¸æ©Ÿï¼šé—œé–‰ look-controlsï¼Œé–å®šä½ç½® -->
<a-camera look-controls="enabled: false"></a-camera>
<!-- å®šç¾©ç¬¬ 0 è™Ÿ AR æ¨™è¨˜ -->
<a-entity mindar-image-target="targetIndex: 0">
<!-- é¡¯ç¤ºåç‰‡çš„å¹³é¢ï¼Œä¸¦æ›ä¸Š touch-transform çµ„ä»¶ -->
<a-plane
src="#resultImg"
width="1.2"
height="0.7"
position="0 0 0"
touch-transform
></a-plane>
</a-entity>
</a-scene>
<!-- è‡ªè¨‚ A-Frame çµ„ä»¶ï¼šè§¸æ§ç¸®æ”¾ã€æ—‹è½‰ã€é›™æ“Šé‡è¨­ -->
<script>
AFRAME.registerComponent('touch-transform', {
init: function () {
const el = this.el;
// ä¿å­˜åŸå§‹ç¸®æ”¾å€¼ï¼Œç”¨æ–¼é›™æ“Šé‡è¨­
this.defaultScale = el.object3D.scale.x;
this.currentScale = this.defaultScale;
this.prevDistance = null;
this.prevAngle = null;
this.lastTap = 0;
// é›™æ“Šé‡è¨­å¤§å°èˆ‡æ—‹è½‰
el.addEventListener('click', () => {
const now = Date.now();
if (now - this.lastTap < 300) {
el.object3D.scale.set(this.defaultScale, this.defaultScale, this.defaultScale);
el.object3D.rotation.set(0, 0, 0);
this.currentScale = this.defaultScale;
}
this.lastTap = now;
});
const canvas = el.sceneEl.canvas;
// åµæ¸¬å…©æŒ‡è§¸æ§é–‹å§‹ï¼šè¨ˆç®—åˆå§‹è·é›¢èˆ‡è§’åº¦
canvas.addEventListener('touchstart', (e) => {
if (e.touches.length === 2) {
const dx = e.touches[0].clientX - e.touches[1].clientX;
const dy = e.touches[0].clientY - e.touches[1].clientY;
this.prevDistance = Math.hypot(dx, dy);
this.prevAngle = Math.atan2(dy, dx);
}
});
// å…©æŒ‡ç§»å‹•æ™‚åŸ·è¡Œç¸®æ”¾èˆ‡æ—‹è½‰
canvas.addEventListener('touchmove', (e) => {
if (e.touches.length === 2 && this.prevDistance !== null) {
const dx = e.touches[0].clientX - e.touches[1].clientX;
const dy = e.touches[0].clientY - e.touches[1].clientY;
const dist = Math.hypot(dx, dy);
const angle = Math.atan2(dy, dx);
// ç¸®æ”¾ï¼šé™åˆ¶åœ¨ 0.5ï½3 å€ä¹‹é–“
const scaleFactor = dist / this.prevDistance;
this.currentScale *= scaleFactor;
this.currentScale = Math.min(Math.max(this.currentScale, 0.5), 3);
el.object3D.scale.set(this.currentScale, this.currentScale, this.currentScale);
// æ—‹è½‰
const deltaAngle = angle - this.prevAngle;
const rot = el.object3D.rotation;
el.object3D.rotation.set(rot.x, rot.y, rot.z + deltaAngle);
// æ›´æ–°åƒè€ƒå€¼
this.prevDistance = dist;
this.prevAngle = angle;
e.preventDefault(); // é¿å…é è¨­æ‰‹å‹¢è¡Œç‚º
}
});
// è§¸æ§çµæŸå¾Œé‡ç½®åƒè€ƒå€¼
canvas.addEventListener('touchend', () => {
if (el.sceneEl.canvas.touches && el.sceneEl.canvas.touches.length < 2) {
this.prevDistance = null;
this.prevAngle = null;
}
});
}
});
</script>
</body>
</html>